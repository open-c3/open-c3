# v0.0.0 sql openc3_connector_sysupdate create from v2.5.11
create table if not exists `openc3_connector_sysupdate`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`uuid` VARCHAR(100) comment 'uuid',
`stat` VARCHAR(100) comment 'stat',
`time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment 'time',
UNIQUE KEY `uniq_uuid` (`uuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='sysupdate';

# v2.5.1 sql openc3_monitor_config_collector create
create table if not exists `openc3_monitor_config_collector`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`projectid` int(16) unsigned comment '项目id',
`type` VARCHAR(100) comment '类型',
`subtype` VARCHAR(100) comment '子类型',
`content1` VARCHAR(300) comment '内容',
`content2` VARCHAR(300) comment '内容',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='monitorconfigcollector';

# v2.5.1 sql openc3_monitor_config_rule create
create table if not exists `openc3_monitor_config_rule`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`projectid` int(16) unsigned comment '项目id',
`alert` VARCHAR(100) comment 'alert',
`expr` VARCHAR(3000) comment 'expr',
`for` VARCHAR(100) comment 'for',
`severity` VARCHAR(100) comment 'severity',
`summary` VARCHAR(1000) comment 'summary',
`description` VARCHAR(1000) comment 'description',
`value` VARCHAR(100) comment 'value',
`model` VARCHAR(100) comment 'model',
`metrics` VARCHAR(100) comment 'metrics',
`method` VARCHAR(20) comment 'method',
`threshold` VARCHAR(100) comment 'threshold',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='monitorconfigrule';

# v2.5.1 sql openc3_monitor_config_user create
create table if not exists `openc3_monitor_config_user`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`projectid` int(16) unsigned comment '项目id',
`user` VARCHAR(100) comment 'user',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='monitorconfiguser';

# v2.5.2 sql openc3_monitor_self_healing_config create
create table if not exists `openc3_monitor_self_healing_config`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`name` VARCHAR(100) comment '自愈套餐名称',
`altername` VARCHAR(100) comment '报警名称',
`jobname` VARCHAR(100) comment '作业名称',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `uniq_altername` (`altername`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='monitor_self_healing_config';

# v2.5.2 sql openc3_monitor_self_healing_task create
create table if not exists `openc3_monitor_self_healing_task`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`instance` VARCHAR(100) comment '目标',
`fingerprint` VARCHAR(100) comment 'fingerprint',
`startsAt` VARCHAR(100) comment 'startsAt',
`alertname` VARCHAR(300) comment 'alertname',
`jobname` VARCHAR(100) comment '作业名称',
`taskuuid` VARCHAR(100) comment '作业任务编号',
`taskstat` VARCHAR(100) comment '作业任务状态',
`healingchecktime` VARCHAR(100) comment '自愈状态检查的时间, 大于这个时间',
`healingstat` VARCHAR(100) comment '自愈状态',
`create_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `uniq_instance_fingerprint_startsAt_alertname` (`instance`,`fingerprint`,`startsAt`,`alertname`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='monitor_self_healing_task';

# v2.5.3 sql openc3_monitor_config_kanban create
create table if not exists `openc3_monitor_config_kanban`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`projectid` int(16) unsigned comment '项目id',
`name` VARCHAR(100) comment '名称',
`url` VARCHAR(3000) comment 'url',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='monitorconfigkanban';

# v2.5.4 sql openc3_monitor_config_kanban add default
ALTER TABLE openc3_monitor_config_kanban ADD `default` int(4) unsigned default 0 comment '默认模版';

# v2.5.5 sql openc3_connector_userdepartment create
create table if not exists `openc3_connector_userdepartment`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`user` VARCHAR(100) comment 'user',
`department` VARCHAR(100) comment 'department',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment 'time',
`edit_user` VARCHAR(100) comment 'edit_user',
UNIQUE KEY `uniq_user` (`user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='userdepartment';

# v2.5.6 sql openc3_monitor_config_group create
create table if not exists `openc3_monitor_config_group`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`name` VARCHAR(300) comment '名称',
`description` VARCHAR(1000) comment '描述',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `name` (`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='监控报警接收组';

# v2.5.6 sql openc3_monitor_config_groupuser create
create table if not exists `openc3_monitor_config_groupuser`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`groupid` int(16) unsigned comment '监控报警接收组id',
`user` VARCHAR(300) comment '用户',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `groupid_user` (`groupid`, `user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='监控报警接收组成员';

# v2.5.7 sql openc3_job_variable add option
ALTER TABLE openc3_job_variable ADD `option` VARCHAR(1000) comment '选项列表';

# v2.5.8 sql openc3_monitor_config_oncall create
create table if not exists `openc3_monitor_config_oncall`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`name` VARCHAR(300) comment '名称',
`description` VARCHAR(1000) comment '描述',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `name` (`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='监控报警值班组';

# v2.5.9 sql openc3_monitor_config_mailmon create
create table if not exists `openc3_monitor_config_mailmon`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`name` VARCHAR(300) comment '名称',
`description` VARCHAR(1000) comment '描述',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `name` (`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='邮件监控';

# v2.5.9 sql openc3_monitor_history_mailmon create
create table if not exists `openc3_monitor_history_mailmon`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`account` VARCHAR(300) comment '账号',
`severity` VARCHAR(300) comment '级别',
`subject` VARCHAR(500) comment '标题',
`content` VARCHAR(1000) comment '内容',
`date` VARCHAR(300) comment '日期',
`from` VARCHAR(300) comment '来源',
`create_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='邮件监控历史';

# v2.5.10 sql openc3_monitor_self_healing_config add eips
ALTER TABLE openc3_monitor_self_healing_config ADD `eips` VARCHAR(500) comment '生效的ip列表';

# skip v2.5.11 sql openc3_connector_sysupdate create
#create table `openc3_connector_sysupdate`(
#`id`            int(16) unsigned not null primary key auto_increment comment 'id',
#`uuid` VARCHAR(100) comment 'uuid',
#`stat` VARCHAR(100) comment 'stat',
#`time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment 'time',
#UNIQUE KEY `uniq_uuid` (`uuid`)
#)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='sysupdate';

# v2.6.0 sql openc3_ci_awsecs create
create table if not exists `openc3_ci_awsecs`(
`id` int(32) unsigned not null primary key auto_increment comment 'id',
`ticketid` VARCHAR(200) comment '凭据ID',
`region` VARCHAR(200) comment 'region',
`cluster` VARCHAR(100) comment 'cluster',
`service` VARCHAR(100) comment 'service',
`taskdef` VARCHAR(100) comment 'taskdef',
`create_time` TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `uniq_awsecs` (`region`,`cluster`,`service`,`taskdef`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='awsecs';

# v2.6.0 sql openc3_job_variable add env
ALTER TABLE openc3_job_variable ADD `env` VARCHAR(10) DEFAULT '' comment '作用在哪个环境中';

# v2.6.0 sql openc3_job_variable_text create
create table if not exists `openc3_job_variable_text`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`uuid` VARCHAR(30) comment 'uuid',
`value` VARCHAR(5000) comment '变量值',
UNIQUE KEY `uniq_variable_text_uuid` (`uuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='作业变量文本扩展';

# v2.6.0 sql openc3_ci_project add cpulimit
ALTER TABLE openc3_ci_project ADD `cpulimit` VARCHAR(10) DEFAULT '' comment 'ci的cpu资源限制';

# v2.6.0 sql openc3_ci_project add memlimit
ALTER TABLE openc3_ci_project ADD `memlimit` VARCHAR(20) DEFAULT '' comment 'ci的mem资源限制';

# v2.6.0 sql openc3_ci_version add queueid
ALTER TABLE openc3_ci_version ADD `queueid` VARCHAR(20) DEFAULT '' comment '队列ID';

# v2.6.0 sql openc3_ci_ticket add pod_shell_relaxed
ALTER TABLE openc3_ci_ticket ADD `pod_shell_relaxed` VARCHAR(2) DEFAULT '0' comment 'pod shell 宽松的';

# v2.6.0 sql openc3_ci_ticket add edit_share
ALTER TABLE openc3_ci_ticket ADD `edit_share` VARCHAR(300) DEFAULT '' comment '凭据自身的编辑权共享';

# v2.6.0 sql openc3_job_nodelist add type
ALTER TABLE openc3_job_nodelist ADD `type` VARCHAR(30) DEFAULT 'extend' comment '资源类型,默认是extend';

# v2.6.0 sql openc3_connector_useraddr add voicemail
ALTER TABLE openc3_connector_useraddr ADD `voicemail` varchar(100) DEFAULT NULL COMMENT 'voicemail';

# v2.6.0 sql openc3_job_approval add assist
ALTER TABLE openc3_job_approval ADD `assist` varchar(100) DEFAULT NULL COMMENT '协助操作人';

# v2.6.0 sql openc3_ci_k8s_namespace_auth create
create table if not exists `openc3_ci_k8s_namespace_auth`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`ticketid`   VARCHAR(200) comment '凭据ID',
`namespace`  VARCHAR(200) comment '命名空间',
`user`       VARCHAR(100) comment '用户',
`auth`       VARCHAR(100) comment '权限',
`edit_user`  VARCHAR(100) comment '编辑者',
`edit_time`  TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `openc3_ci_k8s_namespace_auth` (`ticketid`,`namespace`,`user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='k8s命名空间授权';

# v2.6.0 sql openc3_agent_node_network_check create
create table if not exists `openc3_agent_node_network_check`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`node`   VARCHAR(100) comment 'node节点，一般为ip',
`tcp_speed`  VARCHAR(100) comment 'tcp测速',
`tcp_error`  VARCHAR(100) comment 'tcp错误',
`udp_speed`  VARCHAR(100) comment 'udp测速',
`udp_error`  VARCHAR(100) comment 'udp错误',
`check_time`  TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '检测时间',
UNIQUE KEY `openc3_agent_node_network_check` (`node`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='网络质量监控';

# v2.6.0 sql openc3_ci_flow_network_check create
create table if not exists `openc3_ci_flow_network_check`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`flowid`   VARCHAR(100) comment '流水线ID',
`test_nodes`  VARCHAR(2000) comment '测试套餐节点',
`test_error`  VARCHAR(2000) comment '测试套餐错误',
`online_nodes`  VARCHAR(2000) comment '线上套餐节点',
`online_error`  VARCHAR(2000) comment '线上套餐错误',
`check_time`  TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '检测时间',
UNIQUE KEY `openc3_ci_flow_network_check` (`flowid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='流水线网络质量监控';

# v2.6.0 sql openc3_monitor_cloudmon create
create table if not exists `openc3_monitor_cloudmon`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`name`       VARCHAR(200) comment '账号名称',
`type`       VARCHAR(50) comment '类型',
`describe`   VARCHAR(200) comment 'describe',
`config`     VARCHAR(20000) comment 'config',
`edit_time`  TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='华为云监控';

# v2.6.0 sql openc3_job_smallapplication add treeid step1
ALTER TABLE openc3_job_smallapplication ADD `treeid` varchar(20) DEFAULT 0 COMMENT '放到该服务树ID下';

# v2.6.0 sql openc3_job_smallapplication add treeid step2
ALTER TABLE openc3_job_smallapplication drop index `uniq_jobid`;

# v2.6.0 sql openc3_job_smallapplication add treeid step3
ALTER TABLE openc3_job_smallapplication ADD UNIQUE KEY `uniq_jobid_treeid` (`jobid`,`treeid`);

# v2.6.0 sql openc3_job_plugin_approval_record create
create table if not exists `openc3_job_plugin_approval_record`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`jobxuuid`    VARCHAR(30) comment 'jobxuuid',
`pluginuuid`  VARCHAR(30) comment 'pluginuuid',
`action`      VARCHAR(30) comment 'action',
`deployenv`   VARCHAR(30) comment 'deployenv',
`batches`     VARCHAR(30) comment 'batches'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='审批插件记录';

# v2.6.0 sql openc3_monitor_history_mailmon add to
ALTER TABLE openc3_monitor_history_mailmon ADD `to` varchar(300) DEFAULT NULL COMMENT 'To';

# v2.6.0 sql openc3_monitor_keepalive create
create table if not exists `openc3_monitor_keepalive`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`slave` VARCHAR(40) comment 'slave',
`time` int(16) unsigned comment 'time',
UNIQUE KEY `uniq_slave` (`slave`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='slave心跳';

# v2.6.0 sql openc3_ci_project add buildcachepath
ALTER TABLE openc3_ci_project ADD `buildcachepath` VARCHAR(80) DEFAULT '' comment '构建时的缓存目录';

# v2.6.0 sql openc3_ci_project add saveasdir
ALTER TABLE openc3_ci_project ADD `saveasdir` VARCHAR(4) DEFAULT '0' comment '保存成目录';

# v2.6.0 sql openc3_ci_project add gitclonebycache
ALTER TABLE openc3_ci_project ADD `gitclonebycache` VARCHAR(4) DEFAULT '0' comment 'git clone的时候使用缓存目录';

# v2.6.0 sql openc3_job_plugin_cmd modify scripts_cont to 15000
ALTER TABLE openc3_job_plugin_cmd modify `scripts_cont` varchar(15000) DEFAULT NULL COMMENT '脚本内容,或引用的编号';

# v2.6.0 sql openc3_monitor_node_low create
create table if not exists `openc3_monitor_node_low`(
`id`         int(16) unsigned not null primary key auto_increment comment 'id',
`date`       VARCHAR(40)  comment 'date',
`ip`         VARCHAR(40)  comment 'ip',
`lowcnt`     VARCHAR(40)  comment 'lowcnt',
`status`     VARCHAR(20)  comment '状态',
`mem`        VARCHAR(100) comment 'mem',
`cpu`        VARCHAR(100) comment 'cpu',
`netin`      VARCHAR(100) comment 'netin',
`netout`     VARCHAR(100) comment 'netout',
`edit_time`  TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY  `uniq_ip` (`ip`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='主机低利用率';

# v2.6.0 sql openc3_monitor_node_low_detail create
create table if not exists `openc3_monitor_node_low_detail`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`date`      VARCHAR(40)  comment 'date',
`ip`        VARCHAR(40)  comment 'ip',
`status`    VARCHAR(20)  comment '状态',
`mem`       VARCHAR(100) comment 'mem',
`cpu`       VARCHAR(100) comment 'cpu',
`netin`     VARCHAR(100) comment 'netin',
`netout`    VARCHAR(100) comment 'netout',
UNIQUE KEY `uniq_ip_date` (`ip`, `date`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='主机低利用率-详情';

# v2.6.0 sql openc3_monitor_config_rule add bindtreesql
ALTER TABLE openc3_monitor_config_rule ADD `bindtreesql` VARCHAR(3000) DEFAULT '' comment '绑定服务树的表达式';

# v2.6.0 sql openc3_connector_tree update update_time 2020
update openc3_connector_tree set update_time='2020-01-01 00:00:00' where update_time<'2020-01-01 00:00:00';

# v2.6.0 sql openc3_connector_tree modify name to 200
ALTER TABLE openc3_connector_tree modify `name` varchar(200) COLLATE utf8_unicode_ci NOT NULL COMMENT '节点名';

# v2.6.0 sql openc3_device_bindtree create
create table if not exists `openc3_device_bindtree`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`type`      VARCHAR(40)  comment 'type',
`subtype`   VARCHAR(40)  comment 'subtype',
`uuid`      VARCHAR(150) comment 'uuid',
`tree`      VARCHAR(500) comment 'tree',
UNIQUE KEY `uniq_type_subtype_uuit` (`type`, `subtype`,`uuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='资源绑定服务树';

# v2.6.0 sql openc3_ci_project add nomail
ALTER TABLE openc3_ci_project ADD `nomail` VARCHAR(4) DEFAULT '0' comment '不发送邮件';

# v2.6.0 sql openc3_ci_project add nomesg
ALTER TABLE openc3_ci_project ADD `nomesg` VARCHAR(4) DEFAULT '0' comment '不发送短信';

# v2.6.0 sql openc3_connector_userauthtree create

create table if not exists `openc3_connector_userauthtree`(
`id`     int(16) unsigned not null primary key auto_increment comment 'id',
`name`   VARCHAR(100) comment 'name',
`tree`   VARCHAR(200) comment 'tree',
`level`  VARCHAR(200) comment 'level',
UNIQUE KEY `uniq_name_tree` (`name`,`tree`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='和服务树相关的权限';

# v2.6.0 sql openc3_monitor_config_treeunbind create

create table if not exists `openc3_monitor_config_treeunbind`(
`id`     int(16) unsigned not null primary key auto_increment comment 'id',
`treeid` int(16) unsigned comment 'treeid',
`status` int(4 ) unsigned comment 'status',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '编辑时间',
UNIQUE KEY `uniq_tree` (`treeid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='监控节点服务树断开继承';

# v2.6.0 sql openc3_device_extcol create
create table if not exists `openc3_device_extcol`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`type`      VARCHAR(40)   comment 'type',
`subtype`   VARCHAR(40)   comment 'subtype',
`uuid`      VARCHAR(150)  comment 'uuid',
`name`      VARCHAR(100)  comment 'name',
`data`      VARCHAR(3000) comment 'data',
UNIQUE KEY `uniq_type_subtype_uuit_name` (`type`, `subtype`,`uuid`,`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='资源的扩展列信息';

# v2.6.0 sql openc3_job_approval add everyone
ALTER TABLE openc3_job_approval ADD `everyone` VARCHAR(20) comment '是否每个人都需要审批';

# v2.6.0 sql openc3_job_approval add oasync
ALTER TABLE openc3_job_approval ADD `oasync` VARCHAR(20) DEFAULT 0 comment 'oa同步';

# v2.6.0 sql openc3_job_approval modify remarks to 1000
ALTER TABLE openc3_job_approval modify `remarks` varchar(1000) DEFAULT NULL COMMENT '审批标注内容';

# v2.6.0 sql openc3_device_bindtree modify tree to 1000
ALTER TABLE openc3_device_bindtree modify `tree` varchar(1000) DEFAULT NULL COMMENT 'tree';

# v2.6.0 sql openc3_device_bindtree modify tree to 2000
ALTER TABLE openc3_device_bindtree modify `tree` varchar(2000) DEFAULT NULL COMMENT 'tree';

# v2.6.0 sql openc3_monitor_config_rule add job
ALTER TABLE openc3_monitor_config_rule ADD `job` VARCHAR(100) DEFAULT '' comment '简单模式，选择的job源';

# v2.6.0 sql openc3_tt_base_impact create
create table if not exists `openc3_tt_base_impact` (
`id`           int(11)      unsigned NOT NULL AUTO_INCREMENT,
`level`        int(11)      NOT NULL UNIQUE COMMENT '影响级别',
`name`         varchar(100) UNIQUE COMMENT '名称',
`response_sla` int(11)      unsigned NOT NULL COMMENT '响应sla',
`resolve_sla`  int(11)      unsigned NOT NULL COMMENT '解决sla',
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='影响级别表';

# v2.6.0 sql openc3_tt_base_category create
create table if not exists `openc3_tt_base_category` (
`id`    int(11)      unsigned NOT NULL AUTO_INCREMENT,
`name`  varchar(100) UNIQUE COMMENT '名称',
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='总类表';

# v2.6.0 sql openc3_tt_base_type create
create table if not exists `openc3_tt_base_type` (
`id`          int(11) unsigned NOT NULL AUTO_INCREMENT,
`name`        varchar(100) COMMENT '名称',
`category_id` int(11) unsigned NOT NULL,
PRIMARY KEY (`id`),
UNIQUE(name, category_id),
FOREIGN KEY (`category_id`) REFERENCES openc3_tt_base_category(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='子类表';

# v2.6.0 sql openc3_tt_base_item create
create table if not exists `openc3_tt_base_item` (
`id`          int(11) unsigned NOT NULL AUTO_INCREMENT,
`name`        varchar(100) COMMENT '名称',
`type_id`     int(11) unsigned NOT NULL,
`tpl_title`   varchar(200) COMMENT '模板标题',
`tpl_content` text COMMENT '模板内容',
PRIMARY KEY (`id`),
UNIQUE(name,type_id),
FOREIGN KEY (`type_id`) REFERENCES openc3_tt_base_type(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='名目表';

# v2.6.0 sql openc3_tt_base_group create
create table if not exists `openc3_tt_base_group` (
`id` int(11)      unsigned NOT NULL AUTO_INCREMENT,
`group_name`      varchar(100) COMMENT '组名',
`group_email`     varchar(100) COMMENT '组email',
`admin_email`     varchar(100) COMMENT '管理员email',
`timezone`        int(11) NOT NULL DEFAULT 8 COMMENT '时区',
`work_day`        varchar(50) NOT NULL DEFAULT '1,2,3,4,5' COMMENT '工作日[1,2,3,4,5]',
`work_hour_start` int(11) COMMENT '工作开始时间',
`work_hour_end`   int(11) COMMENT '工作结束时间',
`level1_report`   varchar(100) COMMENT '1-level 投诉人',
`level2_report`   varchar(100) COMMENT '2-level 投诉人',
`level3_report`   varchar(100) COMMENT '3-level 投诉人',
`level4_report`   varchar(100) COMMENT '4-level 投诉人',
`level5_report`   varchar(100) COMMENT '5-level 投诉人',
`disabled` int(1) unsigned DEFAULT 0 COMMENT '是否可用',
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='工作组';

# v2.6.0 sql openc3_tt_base_item_group_map create
create table if not exists `openc3_tt_base_item_group_map` (
`id`       int(11) unsigned NOT NULL AUTO_INCREMENT,
`item_id`  int(11) unsigned NOT NULL,
`group_id` int(11) unsigned NOT NULL,
`priority` int(11) unsigned DEFAULT 0 COMMENT '优先级',
FOREIGN KEY (`item_id`)  REFERENCES openc3_tt_base_item(`id`)  ON DELETE CASCADE,
FOREIGN KEY (`group_id`) REFERENCES openc3_tt_base_group(`id`) ON DELETE CASCADE,
UNIQUE(item_id, group_id),
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='item工作组映射表';

# v2.6.0 sql openc3_tt_base_group_user create
create table if not exists `openc3_tt_base_group_user` (
`id`       int(11) unsigned NOT NULL AUTO_INCREMENT,
`group_id` int(11) unsigned NOT NULL,
`email`    varchar(100) COMMENT '组员邮箱',
`priority` int(11) unsigned DEFAULT 0 COMMENT '优先级',
`disabled` int(1) unsigned DEFAULT 0 COMMENT '禁用',
PRIMARY KEY (`id`),
UNIQUE(group_id, email),
FOREIGN KEY (`group_id`) REFERENCES openc3_tt_base_group(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='组员表';

# v2.6.0 sql openc3_tt_base_email_templates create
create table if not exists `openc3_tt_base_email_templates` (
`id`          int(11) unsigned NOT NULL AUTO_INCREMENT,
`name`        varchar(100) UNIQUE COMMENT '模板名称',
`description` varchar(200) COMMENT '模板描述',
`title`       varchar(300) COMMENT '邮件标题',
`content`     text COMMENT '内容',
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='邮件模板';

# v2.6.0 sql openc3_tt_ticket create
create table if not exists `openc3_tt_ticket` (
`id`                     int(11) unsigned NOT NULL AUTO_INCREMENT,
`no`                     varchar(100) UNIQUE COMMENT '编号',
`submit_user`            varchar(100) COMMENT '提交人',
`apply_user`             varchar(100) COMMENT '申请人',
`status`                 enum('assigned', 'wip', 'pending', 'resolved', 'closed') NOT NULL COMMENT '当前状态',
`impact`                 int(11) unsigned NOT NULL default 1 COMMENT '事件影响',
`category`               int(11) unsigned NOT NULL default 1 COMMENT 'C',
`type`                   int(11) unsigned NOT NULL default 1 COMMENT 'T',
`item`                   int(11) unsigned NOT NULL default 1 COMMENT 'I',
`workgroup`              int(11) unsigned NOT NULL default 1 COMMENT '工作组',
`group_user`             int(11) unsigned COMMENT '指派人',
`title`                  varchar(300) COMMENT '标题',
`content`                text COMMENT '详述',
`email_list`             text COMMENT '抄送列表',
`root_cause`             text COMMENT '根本原因',
`solution`               text COMMENT '解决方案',
`response_time`          DATETIME COMMENT '响应时间',
`response_cost`          int(11) unsigned DEFAULT 0 COMMENT '响应sla耗时(s)',
`response_timeout_sent`  int(11) unsigned DEFAULT 0 COMMENT '响应超时邮件已发送',
`resolve_time`           DATETIME COMMENT '解决时间',
`resolve_cost`           int(11) unsigned DEFAULT 0 COMMENT '解决sla耗时(s)',
`resolve_timeout_sent`   int(11) unsigned DEFAULT 0 COMMENT '解决超时邮件已发送',
`closed_time`            DATETIME COMMENT '关闭时间',
`one_time_resolve_rate`  int(11) unsigned default 0 COMMENT '一次解决率',
`created_at`             DATETIME NOT NULL COMMENT '添加时间',
PRIMARY KEY (`id`),
FOREIGN KEY (`impact`)     REFERENCES openc3_tt_base_impact(`id`),
FOREIGN KEY (`category`)   REFERENCES openc3_tt_base_category(`id`),
FOREIGN KEY (`type`)       REFERENCES openc3_tt_base_type(`id`),
FOREIGN KEY (`item`)       REFERENCES openc3_tt_base_item(`id`),
FOREIGN KEY (`workgroup`)  REFERENCES openc3_tt_base_group(`id`),
FOREIGN KEY (`group_user`) REFERENCES openc3_tt_base_group_user(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1001 DEFAULT CHARSET=utf8 COMMENT='ticket表';

# v2.6.0 sql openc3_tt_ticket_attachment create
create table if not exists `openc3_tt_ticket_attachment` (
`id`         int(11) unsigned NOT NULL AUTO_INCREMENT,
`name`       varchar(200) COMMENT '文件名',
`size`       int(11) COMMENT '文件大小',
`uuid`       varchar(100) UNIQUE COMMENT 'uuid',
`ticket_id`  int(11) unsigned NOT NULL COMMENT 'ticket id',
`created_at` DATETIME NOT NULL COMMENT '添加时间',
PRIMARY KEY (`id`),
FOREIGN KEY (`ticket_id`) REFERENCES openc3_tt_ticket(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='附件表';

# v2.6.0 sql openc3_tt_common_reply_log create
create table if not exists `openc3_tt_common_reply_log` (
`id` int(11) unsigned NOT NULL AUTO_INCREMENT,
`oper_user`  varchar(100) COMMENT 'user',
`content`    varchar(500) COMMENT 'content',
`ticket_id`  int(11) unsigned NOT NULL COMMENT 'ticket id',
`created_at` DATETIME NOT NULL COMMENT '添加时间',
PRIMARY KEY (`id`),
FOREIGN KEY (`ticket_id`) REFERENCES openc3_tt_ticket(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT="replylog表";

# v2.6.0 sql openc3_tt_common_work_log create
create table if not exists `openc3_tt_common_work_log` (
`id` int(11) unsigned NOT NULL AUTO_INCREMENT,
`oper_user`  varchar(100) COMMENT 'user',
`content`    text COMMENT 'content',
`ticket_id`  int(11) unsigned NOT NULL COMMENT 'ticket id',
`created_at` DATETIME NOT NULL COMMENT '添加时间',
PRIMARY KEY (`id`),
FOREIGN KEY (`ticket_id`) REFERENCES openc3_tt_ticket(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT="worklog表";

# v2.6.0 sql openc3_tt_common_sys_log create
create table if not exists `openc3_tt_common_sys_log` (
`id` int(11)  unsigned NOT NULL AUTO_INCREMENT,
`oper_user`   varchar(100) COMMENT '修改人',
`oper_type`   varchar(100) COMMENT '修改类型(add, update, delete)',
`oper_column` varchar(100) COMMENT '修改字段',
`oper_pre`    varchar(200) COMMENT '修改前',
`oper_after`  varchar(200) COMMENT '修改后',
`content`     varchar(500) COMMENT '修改记录描述',
`ticket_id`   int(11) unsigned NOT NULL COMMENT 'ticket id',
`created_at`  DATETIME NOT NULL COMMENT '添加时间',
PRIMARY KEY (`id`),
FOREIGN KEY (`ticket_id`) REFERENCES openc3_tt_ticket(`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT="syslog表";

# v2.6.0 sql openc3_tt_common_lang create
create table if not exists `openc3_tt_common_lang` (
`id`      int(11) unsigned NOT NULL AUTO_INCREMENT,
`lang`    varchar(100) NOT NULL UNIQUE COMMENT 'language',
`langkey` varchar(100) NOT NULL UNIQUE COMMENT 'language key',
`data`    text COMMENT 'data',
PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT="翻译表";

# v2.6.0 cmd tt dbinit 2211041
/data/Software/mydan/Connector/tt/init/dbinit.sh force

# v2.6.0 sql openc3_job_subtask modify pause to 100
ALTER TABLE openc3_job_subtask modify `pause` varchar(100) DEFAULT NULL COMMENT '暂停标志';

# v2.6.0 sql openc3_monitor_ack_active create
create table if not exists `openc3_monitor_ack_active`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`type`      VARCHAR(20)  comment '类型，组还是个人, G or P',
`uuid`      VARCHAR(100) comment 'uuid',
`treeid`    VARCHAR(100) comment '服务树ID',
`expire`    VARCHAR(100) comment '失效时间点',
`ackuuid`   VARCHAR(100) comment 'ackuuid,用于用户管理表格时候找到table表的详细对应关系',
`edit_user` VARCHAR(100) comment '编辑者',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='openc3_monitor_ack_active';

# v2.6.0 sql openc3_monitor_ack_table create
create table if not exists `openc3_monitor_ack_table`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`fingerprint`   VARCHAR(100)  comment 'fingerprint',
`caseuuid`      VARCHAR(100)  comment 'caseuuid',
`ackuuid`       VARCHAR(100)  comment 'ackuuid',
`treeid`        VARCHAR(100)  comment 'treeid',
`labels`        VARCHAR(2000) comment 'labels',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='openc3_monitor_ack_table';

# v2.6.0 sql openc3_connector_user_temp_token create
create table if not exists `openc3_connector_user_temp_token`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`user`      VARCHAR(200)  comment 'user',
`token`     VARCHAR(200)  comment 'token',
`expire`    VARCHAR(100) comment '失效时间点',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='openc3_connector_user_temp_token';

# v2.6.0 sql openc3_monitor_caseinfo create
create table if not exists `openc3_monitor_caseinfo`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`mtime`         VARCHAR(30)   comment '更新时间',
`treeid`        VARCHAR(30)   comment '服务树id',
`ackuuid`       VARCHAR(30)   comment 'ACK编号，方便跳转到ACK页面',
`instance`      VARCHAR(100)  comment 'instance',
`fingerprint`   VARCHAR(100)  comment 'fingerprint',
`caseuuid`      VARCHAR(100)  comment 'caseuuid',
`casestat`      VARCHAR(100)  comment 'case状态',
`title`         VARCHAR(100)  comment '标题',
`content`       VARCHAR(5000) comment '内容',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `uniq_uuid` (`caseuuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='openc3_monitor_caseinfo';

# v2.6.0 sql openc3_monitor_usercase create
create table if not exists `openc3_monitor_usercase`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`user`          VARCHAR(100)  comment '用户',
`caseuuid`      VARCHAR(100)  comment 'caseuuid',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `uniq_uuid` (`user`,`caseuuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='openc3_monitor_usercase';

# v2.6.0 sql openc3_monitor_config_rule add subgroup
ALTER TABLE openc3_monitor_config_rule ADD `subgroup` VARCHAR(50) DEFAULT '' comment '子分组,告警接收人可以根据组配置接收';

# v2.6.0 sql openc3_monitor_config_user add subgroup
ALTER TABLE openc3_monitor_config_user ADD `subgroup` VARCHAR(50) DEFAULT '' comment '子分组,接收部分告警策略的告警';

# v2.6.0 sql openc3_monitor_tott create
create table if not exists `openc3_monitor_tott`(
`id`            int(16) unsigned not null primary key auto_increment comment 'id',
`uuid`          VARCHAR(100)  comment 'alertuuid',
`type`          VARCHAR(10)   comment '0是内部tt，1是外部tt',
`caseuuid`      VARCHAR(100)  comment 'caseuuid',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '创建时间',
UNIQUE KEY `uniq_uuid` (`uuid`,`caseuuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='openc3_monitor_tott';

# v2.6.0 sql openc3_monitor_config_group add share
ALTER TABLE openc3_monitor_config_group ADD `share` VARCHAR(200) DEFAULT '' comment '告警组成员编辑权限共享';

# v2.6.0 sql openc3_job_task add extid
ALTER TABLE openc3_job_task ADD `extid` VARCHAR(50) DEFAULT '' comment '外部关联ID，比如BPM单号';

# v2.6.0 sql openc3_job_bpm_log create
create table if not exists `openc3_job_bpm_log`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`bpmuuid` VARCHAR(50) comment 'uuid',
`step`    VARCHAR(50) comment '步骤',
`info`    VARCHAR(1000) comment '日志内容',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='BPM日志';


# v2.6.0 sql openc3_connector_useraddr modify phone to 500
ALTER TABLE openc3_connector_useraddr modify `phone` varchar(500) DEFAULT NULL COMMENT 'phone';

# v2.6.0 sql openc3_monitor_config_rule add nocall
ALTER TABLE openc3_monitor_config_rule ADD `nocall` VARCHAR(2) DEFAULT '0' comment '忽略电话';

# v2.6.0 sql openc3_monitor_config_rule add nomesg
ALTER TABLE openc3_monitor_config_rule ADD `nomesg` VARCHAR(2) DEFAULT '0' comment '忽略短信';

# v2.6.0 sql openc3_monitor_config_rule add nomail
ALTER TABLE openc3_monitor_config_rule ADD `nomail` VARCHAR(2) DEFAULT '0' comment '忽略邮件';

# v2.6.0 sql openc3_ci_project add notifyci
ALTER TABLE openc3_ci_project ADD `notifyci` varchar(200) DEFAULT NULL COMMENT 'CI消息通知的用户';

# v2.6.0 sql openc3_ci_project add notifycd
ALTER TABLE openc3_ci_project ADD `notifycd` varchar(200) DEFAULT NULL COMMENT 'CD消息通知的用户';

# v2.6.0 sql openc3_connector_userleader create
create table if not exists `openc3_connector_userleader`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`user`    VARCHAR(200) comment '用户',
`leader1` VARCHAR(200) comment '第一层领导',
`leader2` VARCHAR(200) comment '第二层领导',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间',
UNIQUE KEY `uniq_uuid` (`user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='用户领导信息';

# v2.6.0 sql openc3_device_account_huawei create
create table if not exists `openc3_device_account_huawei`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`accesskey`   VARCHAR(400) comment 'ak',
`secretkey`   VARCHAR(400) comment 'sk',
`project`     VARCHAR(200) comment '项目',
`region`      VARCHAR(200) comment '区域',
`iamid`       VARCHAR(200) comment '华为云iam用户id',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='华为云账号';

# v2.6.0 sql openc3_device_account_aws create
create table if not exists `openc3_device_account_aws`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`accesskey`   VARCHAR(400) comment 'ak',
`secretkey`   VARCHAR(400) comment 'sk',
`region`      VARCHAR(200) comment '区域',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='AWS账号';

# v2.6.0 sql openc3_device_account_aliyun create
create table if not exists `openc3_device_account_aliyun`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`accesskey`   VARCHAR(400) comment 'ak',
`secretkey`   VARCHAR(400) comment 'sk',
`region`      VARCHAR(200) comment '区域',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='阿里云账号';

# v2.6.0 sql openc3_device_account_qcloud create
create table if not exists `openc3_device_account_qcloud`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`accesskey`   VARCHAR(400) comment 'ak',
`secretkey`   VARCHAR(400) comment 'sk',
`region`      VARCHAR(200) comment '区域',
`accountid`   VARCHAR(200) comment '账号ID',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='腾讯云账号';

# v2.6.0 sql openc3_device_account_ksyun create
create table if not exists `openc3_device_account_ksyun`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`accesskey`   VARCHAR(400) comment 'ak',
`secretkey`   VARCHAR(400) comment 'sk',
`region`      VARCHAR(200) comment '区域',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='金山云账号';

# v2.6.0 sql openc3_device_account_google create
create table if not exists `openc3_device_account_google`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`credentials` VARCHAR(20000) comment '凭证内容',
`region`      VARCHAR(200) comment '区域',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='谷歌云账号';

# v2.6.0 sql openc3_device_account_ibm create
create table if not exists `openc3_device_account_ibm`(
`id`          int(16) unsigned not null primary key auto_increment comment 'id',
`accountname` VARCHAR(200) comment '账号名称',
`username`    VARCHAR(400) comment 'username',
`api_key`     VARCHAR(400) comment 'api_key',
`vpc_name`    VARCHAR(200) comment 'vpc_name',
`note`        VARCHAR(200) comment '备注',
`edit_user`   VARCHAR(200) comment '编辑人',
`edit_time` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '最后编辑时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='IBM账号';

# v2.6.0 sql openc3_job_approval modify cont to 20000
ALTER TABLE openc3_job_approval modify `cont` varchar(20000) DEFAULT NULL COMMENT '审批内容';

# v2.6.0 sql openc3_job_bpm_usr create
create table if not exists `openc3_job_bpm_usr`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`bpmuuid` VARCHAR(50) comment 'uuid',
`user`    VARCHAR(400) comment '用户',
`curr`    int(1) unsigned DEFAULT 0 COMMENT '是否是当前处理人',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间',
UNIQUE KEY `uniq_bpmuuid_user` (`bpmuuid`,`user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='BPM处理人';

# v2.6.0 sql openc3_job_bpm_protect create
create table if not exists `openc3_job_bpm_protect`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`bpmuuid`  VARCHAR(50)   comment 'uuid',
`stat`     VARCHAR(10)   comment '状态，danger、refuse、agree',
`info`     VARCHAR(2000) comment '流程保护的提示信息',
`operator` VARCHAR(200)  comment '操作人',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间',
UNIQUE KEY `uniq_bpmuuid` (`bpmuuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='BPM流程保护';

# v2.6.0 sql openc3_connector_user_login_audit create
create table if not exists `openc3_connector_user_login_audit`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`user`    VARCHAR(100)   comment 'user',
`uuid`    VARCHAR(50)    comment 'uuid',
`action`  VARCHAR(10)    comment '动作',
`ip`      VARCHAR(100)   comment 'ip',
`t`       VARCHAR(30)    comment '时间秒数',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间'
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='用户登录审计';

# v2.6.0 sql openc3_ci_project modify tag_regex to 100
ALTER TABLE openc3_ci_project modify `tag_regex` varchar(100) DEFAULT NULL COMMENT '正则表达式';

# v2.6.0 sql openc3_job_bpm_deal create
create table if not exists `openc3_job_bpm_deal`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`bpmuuid`  VARCHAR(50)   comment 'uuid',
`dealer`   VARCHAR(100)  comment 'dealer',
`status`   VARCHAR(20)   comment 'status',
`time`     TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间',
UNIQUE KEY `uniq_bpmuuid` (`bpmuuid`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='BPM处理设置';

# v2.6.0 sql openc3_connector_mfa create
create table if not exists `openc3_connector_mfa`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`user`     VARCHAR(100)  comment 'user',
`type`     VARCHAR(50)   comment 'type',
`status`   VARCHAR(20)   comment 'status',
UNIQUE KEY `uniq_user` (`user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='MFA 二次验证';

# v2.6.0 sql openc3_connector_mfa_google create
create table if not exists `openc3_connector_mfa_google`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`user`     VARCHAR(100)  comment 'user',
`secret`   VARCHAR(100)  comment 'secret',
UNIQUE KEY `uniq_user` (`user`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='MFA 二次验证,Google';

# v2.6.0 sql openc3_connector_mfakey create
create table if not exists `openc3_connector_mfakey`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`user`     VARCHAR(100)  comment 'user',
`keys`     VARCHAR(100)  comment 'type',
`pwmd5`    VARCHAR(50)   comment 'passwordMd5',
`time`     VARCHAR(20)   comment 'time',
UNIQUE KEY `uniq_keys` (`keys`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='MFA 二次验证,用于映射用户';

# v2.6.0 sql openc3_job_bpm_menu create
create table if not exists `openc3_job_bpm_menu`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`name`      VARCHAR(200)  comment '名称',
`alias`     VARCHAR(200)  comment '中文别名',
`describe`  VARCHAR(2000) comment '描述',
`show`      VARCHAR(10)   DEFAULT '1'  comment '是否显示',
`type`      VARCHAR(20)   comment '类型',
`uuid`      VARCHAR(20)   comment '操作编号',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间',
UNIQUE KEY `uniq_name` (`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='BPM菜单';

# v2.6.0 sql openc3_connector_navigation create
create table if not exists `openc3_connector_navigation`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`name`      VARCHAR(200)  comment '名称',
`describe`  VARCHAR(2000) comment '描述',
`url`       VARCHAR(2000) comment 'url',
`show`      VARCHAR(10)   DEFAULT '1'  comment '是否显示',
`time`    TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP comment '时间',
UNIQUE KEY `uniq_name` (`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='网址导航';

# v2.6.0 sql openc3_monitor_node_low_mark create
create table if not exists `openc3_monitor_node_low_mark`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`ip`        VARCHAR(40)   comment 'ip',
`operator`  VARCHAR(80)   comment '操作人',
`expires`   VARCHAR(20)   comment '过期时间，秒数',
`mark`      VARCHAR(2000) comment '描述',
UNIQUE KEY `uniq_ip` (`ip` )
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='主机低利用率-标记';

# v2.6.0 sql openc3_connector_vtree create
create table if not exists `openc3_connector_vtree`(
`id`        int(16) unsigned not null primary key auto_increment comment 'id',
`treeid`    int(16) unsigned comment '真实的服务树ID',
`name`      VARCHAR(200)     comment '名称',
UNIQUE KEY `uniq_treeid_name` (`treeid`,`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='虚拟服务树';

# v2.6.0 sql openc3_connector_vnode create
create table if not exists `openc3_connector_vnode`(
`id` int(16) unsigned not null primary key auto_increment comment 'id',
`vtreeid`   int(16) unsigned comment '虚拟服务树id',
`name`      VARCHAR(200)     comment '主机名',
UNIQUE KEY `uniq_name` (`vtreeid`,`name`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 comment='虚拟服务树下面的主机';

# v2.6.0 sql openc3_connector_vtree init
insert into openc3_connector_vtree(`id`) value(3000000000);
